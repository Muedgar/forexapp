(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7704],{46261:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/hooks",function(){return s(15576)}])},87062:function(e,t,s){"use strict";s.d(t,{QI:function(){return n},cK:function(){return a}});var l=s(45455),r=s.n(l);function a(e){let t=null==e?void 0:e.split(",");return r()(e)||!t||(null==t?void 0:t.length)==0?{value:[]}:{value:t.map(t=>{let s=t.trim().split(" ");return 2===s.length?{name:s[0],type:s[1]}:1===s.length?{name:s[0],type:s[0]}:void console.error("Error while trying to parse function arguments",e)}).filter(Boolean)}}function n(e){let t=[];if(e)for(var s in e)t.push({name:s,value:e[s]});return{value:t}}},14698:function(e,t,s){"use strict";s.d(t,{iN:function(){return j},ph:function(){return u},by:function(){return g},hj:function(){return p},B4:function(){return m},S0:function(){return f},ld:function(){return r}});var l=s(52322);function r(e){return(0,l.jsxs)("div",{className:"mx-auto max-w-4xl px-5 pt-12 pb-20",children:[e.header&&(0,l.jsx)("h1",{className:"text-foreground mb-8 text-3xl",children:e.header}),(0,l.jsx)("div",{className:"space-y-20",children:e.children})]})}var a=s(17172),n=s(39097),i=s.n(n),o=s(14048),c=s(80435),d=s(32079);let u=e=>{let{title:t,description:s,docsUrl:r,actions:n,className:u}=e;return(0,l.jsxs)("div",{className:"mb-6 flex items-center justify-between ".concat(u),children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("h3",{className:"text-foreground text-xl",children:(0,l.jsx)(o.D,{unwrapDisallowed:!0,disallowedElements:["p"],children:t})}),s&&(0,l.jsx)(c.U,{content:s,className:"max-w-full"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-x-2",children:[void 0!==r&&(0,l.jsx)(d.z,{asChild:!0,type:"default",icon:(0,l.jsx)(a.Z,{size:14}),children:(0,l.jsx)(i(),{href:r,target:"_blank",rel:"noreferrer",children:"Documentation"})}),n]})]})};var h=s(2784);let p=e=>{let{children:t,id:s,header:r,disabled:a,className:n}=e;return(0,l.jsxs)("div",{id:s,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(a?" opacity-30":" opacity-100"),"".concat(n)].join(" "),children:[r,t]})},f=e=>{let{children:t,className:s="",description:r}=e;return void 0!==r?(0,l.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(s),children:[(0,l.jsx)("label",{className:"text-foreground text-sm",children:t}),r]}):(0,l.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(s),children:t})},x=()=>(0,l.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,l.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,l.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,l.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),m=e=>{let{children:t,loading:s=!0,fullWidth:r,className:a}=e;return(0,l.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(r&&"!col-span-12","\n        ").concat(a,"\n      "),children:s?h.Children.map(t,()=>(0,l.jsx)(x,{})):t})},g=e=>{let{children:t,header:s,footer:r}=e;return(0,l.jsxs)("div",{className:" bg-surface-100 border-default overflow-hidden  rounded-md border shadow",children:[s&&(0,l.jsx)("div",{className:"border-default border-b px-8 py-4",children:s}),(0,l.jsx)("div",{className:"divide-border flex flex-col gap-0 divide-y",children:t}),r&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"border-default border-t"}),r]})]})},j=e=>{let{form:t,hasChanges:s,handleReset:r,helper:a,disabled:n=!1,isSubmitting:i,submitText:o="Save"}=e,c=i||n||!s&&void 0!==s;return(0,l.jsxs)("div",{className:["flex w-full items-center gap-2",a?"justify-between":"justify-end"].join(" "),children:[a&&(0,l.jsx)("span",{className:"text-sm text-foreground-lighter",children:a}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(d.z,{disabled:c,type:"default",htmlType:"reset",onClick:()=>r(),children:"Cancel"}),(0,l.jsx)(d.z,{form:t,type:"primary",htmlType:"submit",disabled:c,loading:i,children:o})]})]})}},95569:function(e,t,s){"use strict";s.d(t,{_:function(){return c}});var l=s(85945),r=s(48228),a=s(62202),n=s(31696),i=s(7161);async function o(e){let{projectRef:t,config:s}=e,{data:l,error:r}=await (0,n.r$)("/platform/auth/{ref}/config",{params:{path:{ref:t}},body:{...s}});return r&&(0,n.S3)(r),l}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.NL)();return(0,r.D)(e=>o(e),{async onSuccess(t,s,l){let{projectRef:r}=s;await n.invalidateQueries(i.o.authConfig(r)),await (null==e?void 0:e(t,s,l))},async onError(e,s,l){void 0===t?a.ZP.error("Failed to update auth configuration: ".concat(e.message)):t(e,s,l)},...s})}},7509:function(e,t,s){"use strict";s.d(t,{R:function(){return i}});var l=s(36492),r=s(31696),a=s(3641);async function n(e,t){let{projectRef:s,connectionString:l}=e;if(!s)throw Error("projectRef is required");let a=new Headers;l&&a.set("x-connection-encrypted",l);let{data:n,error:i}=await (0,r.U2)("/platform/pg-meta/{ref}/functions",{params:{path:{ref:s}},headers:a,signal:t});return i&&(0,r.S3)(i),n}let i=function(e){let{projectRef:t,connectionString:s}=e,{enabled:r=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,l.a)(a.l.list(t),e=>{let{signal:l}=e;return n({projectRef:t,connectionString:s},l)},{enabled:r&&void 0!==t,...i})}},3641:function(e,t,s){"use strict";s.d(t,{l:function(){return l}});let l={list:e=>["projects",e,"database-functions"]}},15576:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eu}});var l=s(52322),r=s(59491),a=s(2784),n=s(62202),i=s(99959),o=s(56006),c=s(14698),d=s(33635),u=s(95569),h=s(14528),p=s(74138),f=s(78232),x=s(34503),m=s(32079);let g=[{title:"Send SMS hook",subtitle:"Will be called by Supabase Auth each time an SMS message needs to be sent.",enabledKey:"HOOK_SEND_SMS_ENABLED",uriKey:"HOOK_SEND_SMS_URI",secretsKey:"HOOK_SEND_SMS_SECRETS",enterprise:!1},{title:"Send Email hook",subtitle:"Will be called by Supabase Auth each time an email message needs to be sent.",enabledKey:"HOOK_SEND_EMAIL_ENABLED",uriKey:"HOOK_SEND_EMAIL_URI",secretsKey:"HOOK_SEND_EMAIL_SECRETS",enterprise:!1},{title:"Customize Access Token (JWT) Claims hook",subtitle:"Will be called by Supabase Auth each time a new JWT is created. It should return the claims you wish to be present in the JWT.",enabledKey:"HOOK_CUSTOM_ACCESS_TOKEN_ENABLED",uriKey:"HOOK_CUSTOM_ACCESS_TOKEN_URI",secretsKey:"HOOK_CUSTOM_ACCESS_TOKEN_SECRETS",enterprise:!1},{title:"MFA Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to verify an MFA factor. Return a decision on whether to reject the attempt and future ones, or to allow the user to keep trying.",enabledKey:"HOOK_MFA_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_MFA_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_MFA_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0},{title:"Password Verification Attempt hook",subtitle:"Will be called by Supabase Auth each time a user tries to sign in with a password. Return a decision whether to allow the user to reject the attempt, or to allow the user to keep trying.",enabledKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_ENABLED",uriKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_URI",secretsKey:"HOOK_PASSWORD_VERIFICATION_ATTEMPT_SECRETS",enterprise:!0}],j=(e,t)=>{if(e.startsWith("https"))return{type:"https",url:e,secret:t||""};{let[t,s,l,r,a]=(e||"").split("/");return{type:"postgres",schema:r||"",functionName:a||""}}},b=e=>"postgres"===e.method.type&&e.method.schema.length>0&&e.method.functionName.length>0||"https"===e.method.type&&e.method.url.startsWith("https")&&e.method.secret.length>0;var y=s(93463),N=s(99248);let v=e=>{let{buttonText:t="Add hook",onSelectHook:s}=e,{ref:r}=(0,i.UO)(),a=(0,h.lL)(),{data:n}=(0,y.G)({orgSlug:null==a?void 0:a.slug},{enabled:N.Qy}),{data:o,error:c,isError:u}=(0,d.$E)({projectRef:r}),p=g.map(e=>({...e,enabled:(null==o?void 0:o[e.enabledKey])||!1,method:j((null==o?void 0:o[e.uriKey])||"",(null==o?void 0:o[e.secretsKey])||"")})),v=p.filter(e=>!b(e)&&!e.enterprise),w=p.filter(e=>!b(e)&&e.enterprise);return(0,l.jsxs)(x.h_,{modal:!1,children:[(0,l.jsx)(x.$F,{asChild:!0,children:(0,l.jsx)(m.z,{type:"primary",iconRight:(0,l.jsx)(f.Z,{className:"w-4 h-4",strokeWidth:1}),children:t})}),(0,l.jsxs)(x.AW,{className:"w-76 p-0",align:"end",children:[(0,l.jsx)("div",{className:"p-1",children:v.map(e=>(0,l.jsx)(x.Xi,{onClick:()=>s(e.title),children:e.title},e.title))}),v.length>0&&(0,l.jsx)(x.VD,{}),(0,l.jsxs)("div",{className:"bg-surface-200 p-1 -mt-2",children:[(null==n?void 0:n.plan.id)!=="enterprise"&&(0,l.jsxs)(x.Ju,{className:"grid gap-1 bg-surface-200",children:[(0,l.jsx)("p",{className:"text-foreground-light",children:"Enterprise plan required"}),(0,l.jsxs)("p",{className:"text-foreground-lighter text-xs",children:["The following hooks are not available on"," ",(0,l.jsx)("a",{target:"_href",href:"https://forms.supabase.com/enterprise",className:"underline",children:"your plan"}),"."]})]}),w.map(e=>(0,l.jsx)(x.Xi,{disabled:!0,className:"cursor-not-allowed",onClick:()=>s(e.title),children:e.title},e.title))]})]})]})};var w=s(88883),S=s(95003),_=s.n(S),k=s(63955),T=s(30195),E=s(92286),C=s(8609),O=s(14048),K=s(7117),A=s(54383),z=s(95392),V=s(22574),R=s(93705),I=s(6019),P=s(6112),D=s(7968);let Z=a.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,l.jsx)(I.fC,{className:(0,A.cn)("flex flex-col -space-y-px w-full",s),...r,ref:t})});Z.displayName="RadioGroupStacked";let H=a.forwardRef((e,t)=>{let{image:s,label:r,showIndicator:a=!0,...n}=e;return(0,l.jsx)(I.ck,{ref:t,...n,className:(0,A.cn)("flex flex-col gap-2","w-full","bg-overlay/50","border","first-of-type:rounded-t-md last-of-type:rounded-b-md","shadow-sm","hover:bg-surface-300","hover:border-foreground-muted","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-1 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground-muted","transition","group",n.className),children:(0,l.jsxs)("div",{className:"flex gap-3 w-full px-[21px] py-[16px]",children:[a&&(0,l.jsx)("div",{className:" aspect-square h-4 w-4  rounded-full border group-data-[state=checked]:border-foreground-muted group-focus:border-foreground-muted group-hover:border-foreground-muted ring-offset-background  group-focus:outline-none  group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2  group-disabled:cursor-not-allowed group-disabled:opacity-50 flex items-center justify-center transition ",children:(0,l.jsx)(I.z$,{className:"flex items-center justify-center",children:(0,l.jsx)(D.Z,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)(P._,{htmlFor:n.value,className:(0,A.cn)("block","-mt-[0.05rem]","text-sm transition-colors text-left","text-light","group-hover:text-foreground group-data-[state=checked]:text-foreground",n.disabled?"cursor-not-allowed":"cursor-pointer"),children:r}),n.description&&(0,l.jsx)("p",{className:"text-xs text-foreground-lighter",children:n.description}),n.children]})]})})});H.displayName="RadioGroupStackedItem";var W=s(42070),F=s(87668),M=s(95492),U=s(61786),L=s(90504),B=s(19869),J=s(90488),X=s(87062),G=s(27570),Y=s(7509),$=s(30339),q=e=>{let{className:t,size:s="tiny",showError:r=!0,disabled:n=!1,schema:i,value:o,onChange:c}=e,{project:d}=(0,G.d2)(),[u,h]=(0,a.useState)(!1),{data:p,error:f,isLoading:x,isError:g,isSuccess:j,refetch:b}=(0,Y.R)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString}),y=(null!=p?p:[]).filter(e=>i&&e.schema===i).filter(e=>"json"===e.return_type||"jsonb"===e.return_type).filter(e=>{let{value:t}=(0,X.cK)(e.argument_types);return 1===t.length&&("json"===t[0].type||"jsonb"===t[0].type)});return(0,l.jsxs)("div",{className:t,children:[x&&(0,l.jsx)(m.z,{type:"default",className:"justify-start",block:!0,size:s,loading:!0,children:"Loading functions..."}),r&&g&&(0,l.jsxs)(M.bZ,{variant:"warning",className:"!px-3 !py-3",children:[(0,l.jsx)(M.Cd,{className:"text-xs text-amber-900",children:"Failed to load functions"}),(0,l.jsxs)(M.X,{className:"text-xs mb-2",children:["Error: ",f.message]}),(0,l.jsx)(m.z,{type:"default",size:"tiny",onClick:()=>b(),children:"Reload functions"})]}),j&&(0,l.jsxs)(U.J2,{open:u,onOpenChange:h,modal:!1,children:[(0,l.jsx)(U.xo,{asChild:!0,children:(0,l.jsx)(m.z,{size:s,type:"default",className:"w-full [&>span]:w-full ".concat("small"===s?"py-1.5":""),iconRight:(0,l.jsx)($.Z,{className:"text-foreground-light rotate-90",strokeWidth:2,size:12}),disabled:!!n,children:(0,l.jsxs)("div",{className:"w-full flex gap-1",children:[(0,l.jsx)("p",{className:"text-foreground-lighter",children:"function:"}),(0,l.jsx)("p",{className:"text-foreground",children:o})]})})}),(0,l.jsx)(U.yk,{className:"p-0",side:"bottom",align:"start",sameWidthAsTrigger:!0,children:(0,l.jsxs)(L.mY,{children:[(0,l.jsx)(L.sZ,{placeholder:"Search functions..."}),(0,l.jsxs)(L.e8,{children:[(0,l.jsx)(L.rb,{children:"No functions found"}),(0,l.jsx)(L.fu,{children:(0,l.jsxs)(B.x,{className:(y||[]).length>7?"h-[210px]":"",children:[!(y||[]).length&&(0,l.jsx)(L.di,{disabled:!0,className:"flex items-center justify-between space-x-2 w-full",children:(0,l.jsxs)("span",{children:["No function with a single JSON/B argument",(0,l.jsx)("br",{}),"and JSON/B return type found in this schema."]})},"no-function-found"),null==y?void 0:y.map(e=>(0,l.jsxs)(L.di,{value:e.name.replaceAll('"',""),className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{c(e.name),h(!1)},onClick:()=>{c(e.name),h(!1)},children:[(0,l.jsx)("span",{children:e.name}),o===e.name&&(0,l.jsx)(J.Z,{className:"text-brand",strokeWidth:2})]},e.id))]})})]})]})})]})]})};let Q="create-edit-auth-hook",ee=T.Ry({hookType:T.Z_(),enabled:T.O7(),selectedType:T.G0([T.i0("https"),T.i0("postgres")]),httpsValues:T.Ry({url:T.Z_(),secret:T.Z_()}),postgresValues:T.Ry({schema:T.Z_(),functionName:T.Z_()})}).superRefine((e,t)=>("https"!==e.selectedType||(e.httpsValues.url.startsWith("https://")||t.addIssue({path:["httpsValues","url"],code:T.NL.custom,message:"The URL must start with https://"}),e.httpsValues.secret||t.addIssue({path:["httpsValues","secret"],code:T.NL.custom,message:"Missing secret value"})),"postgres"!==e.selectedType||(e.postgresValues.schema||t.addIssue({path:["postgresValues","schema"],code:T.NL.custom,message:"You must select a schema"}),e.postgresValues.functionName||t.addIssue({path:["postgresValues","functionName"],code:T.NL.custom,message:"You must select a Postgres function"})),!0)),et=e=>{let{visible:t,onClose:s,onDelete:r,title:o,authConfig:c}=e,{ref:d}=(0,i.UO)(),{mutate:p,isLoading:f}=(0,u._)(),x=(0,h.P5)("httpsAuthHooksEnabled"),y=(0,a.useMemo)(()=>g.find(e=>e.title===o)||g[0],[o]),N=!b({...y,enabled:(null==c?void 0:c[y.enabledKey])||!1,method:j((null==c?void 0:c[y.uriKey])||"",(null==c?void 0:c[y.secretsKey])||"")}),v=(0,k.cI)({resolver:(0,w.F)(ee),defaultValues:{hookType:o||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}}});(0,a.useEffect)(()=>{if(t){if(y){let e=j((null==c?void 0:c[y.uriKey])||"",(null==c?void 0:c[y.secretsKey])||"");v.reset({hookType:y.title,enabled:(null==c?void 0:c[y.enabledKey])||!1,selectedType:e.type,httpsValues:{url:"https"===e.type&&e.url||"",secret:"https"===e.type&&e.secret||""},postgresValues:{schema:"postgres"===e.type&&e.schema||"public",functionName:"postgres"===e.type&&e.functionName||""}})}else v.reset({hookType:o||"",enabled:!0,selectedType:"postgres",httpsValues:{url:"",secret:""},postgresValues:{schema:"public",functionName:""}})}},[c,o,t]);let S=async e=>{let t=g.find(t=>e.hookType===t.title);if(!t)return;let l=t.enabledKey,r=t.uriKey,a=t.secretsKey,i="";i="postgres"===e.selectedType?"pg-functions://postgres/".concat(e.postgresValues.schema,"/").concat(e.postgresValues.functionName):e.httpsValues.url,p({projectRef:d,config:{[l]:e.enabled,[r]:i,[a]:"https"===e.selectedType?e.httpsValues.secret:null}},{onSuccess:()=>{n.ZP.success("Successfully created ".concat(e.hookType,".")),s()}})},T=v.getValues();return(0,l.jsx)(K.yo,{open:t,onOpenChange:()=>s(),children:(0,l.jsxs)(K.ue,{showClose:!1,className:"flex flex-col gap-0",children:[(0,l.jsx)(K.Tu,{className:"py-3 flex flex-row justify-between items-center border-b-0",children:(0,l.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,l.jsxs)(K.sw,{className:(0,A.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),children:[(0,l.jsx)(C.Z,{className:"h-3 w-3"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,l.jsx)(K.bC,{className:"truncate",children:N?"Add ".concat(o):"Update ".concat(o)})]})}),(0,l.jsx)(z.Z,{}),(0,l.jsx)(V.l0,{...v,children:(0,l.jsxs)("form",{id:Q,className:"space-y-6 w-full py-8 flex-1",onSubmit:v.handleSubmit(S),children:[(0,l.jsx)(V.Wi,{control:v.control,name:"enabled",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{className:"px-8",label:"Enable ".concat(T.hookType),layout:"flex",children:(0,l.jsx)(V.NI,{children:(0,l.jsx)(R.r,{checked:t.value,onCheckedChange:t.onChange,disabled:t.disabled})})})}},"enabled"),(0,l.jsx)(z.Z,{}),x&&(0,l.jsx)(V.Wi,{control:v.control,name:"selectedType",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{label:"Hook type",className:"px-8",children:(0,l.jsx)(V.NI,{children:(0,l.jsxs)(Z,{value:T.selectedType,onValueChange:e=>t.onChange(e),children:[(0,l.jsx)(H,{value:"postgres",id:"postgres",label:"Postgres",description:"Used to call a Postgres function."},"postgres"),(0,l.jsx)(H,{value:"https",id:"https",label:"HTTPS",description:"Used to call any HTTPS endpoint."},"https")]})})})}}),"postgres"===T.selectedType?(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-8 px-8",children:[(0,l.jsx)(V.Wi,{control:v.control,name:"postgresValues.schema",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{label:"Postgres Schema",description:"Postgres schema where the function is defined.",children:(0,l.jsx)(V.NI,{children:(0,l.jsx)(E.Z,{size:"small",showError:!1,selectedSchemaName:t.value,onSelectSchema:e=>{t.onChange(e)},disabled:t.disabled})})})}},"postgresValues.schema"),(0,l.jsx)(V.Wi,{control:v.control,name:"postgresValues.functionName",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{label:"Function name",description:"Postgres function which will be called by Supabase Auth each time the hook is triggered.",children:(0,l.jsx)(V.NI,{children:(0,l.jsx)(q,{size:"small",schema:T.postgresValues.schema,value:t.value,onChange:t.onChange,disabled:t.disabled})})})}},"postgresValues.functionName")]}):(0,l.jsxs)("div",{className:"flex flex-col px-8 gap-4",children:[(0,l.jsx)(V.Wi,{control:v.control,name:"httpsValues.url",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{label:"URL",description:"Supabase Auth will send a HTTPS POST request to this URL each time the hook is triggered.",children:(0,l.jsx)(V.NI,{children:(0,l.jsx)(W.I,{...t})})})}},"httpsValues.url"),(0,l.jsx)(V.Wi,{control:v.control,name:"httpsValues.secret",render:e=>{let{field:t}=e;return(0,l.jsx)(F.E,{label:"Secret",description:(0,l.jsx)(O.D,{children:"It should be a base64 encoded hook secret with a prefix `v1,whsec_`. `v1` denotes the signature version, and `whsec_` signifies a symmetric secret."}),children:(0,l.jsx)(V.NI,{children:(0,l.jsxs)("div",{className:"flex flex-row",children:[(0,l.jsx)(W.I,{...t,className:"rounded-r-none border-r-0"}),(0,l.jsx)(m.z,{type:"default",size:"small",className:"rounded-l-none h-[38px]",onClick:()=>{let e=function(){let e=_()(60).toString("base64");return"v1,whsec_".concat(e)}();v.setValue("httpsValues.secret",e)},children:"Generate secret"})]})})})}},"httpsValues.secret")]})]})}),(0,l.jsxs)(K.FF,{children:[!N&&(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)(m.z,{type:"danger",onClick:()=>r(),children:"Delete hook"})}),(0,l.jsx)(m.z,{disabled:f,type:"default",onClick:()=>s(),children:"Cancel"}),(0,l.jsx)(m.z,{form:Q,htmlType:"submit",disabled:f,loading:f,children:N?"Create":"Update"})]})]})})};var es=s(9235),el=s(76141),er=s(750),ea=s(81076);let en=e=>{let{hook:t,canUpdateConfig:s,onToggle:r,onSelect:a}=e;return(0,l.jsxs)("div",{className:"bg-surface-100 border-default overflow-hidden border shadow px-5 py-4 flex flex-row first:rounded-t-md last:rounded-b-md space-x-4",children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(es.Z,{size:21,strokeWidth:"1"})}),(0,l.jsxs)("div",{className:"flex flex-col flex-0 overflow-y-auto w-full",children:[(0,l.jsx)("span",{className:"text-sm text-foreground",children:t.title}),(0,l.jsx)("span",{className:"text-sm text-foreground-lighter",children:t.subtitle}),(0,l.jsx)("div",{className:"text-sm flex flex-row space-x-5 py-4",children:"postgres"===t.method.type?(0,l.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,l.jsx)("span",{className:"text-foreground",children:"Postgres function"})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"schema"}),(0,l.jsx)(er.Z,{title:t.method.schema,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.schema,onCopy:()=>{}})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"function"}),(0,l.jsx)(er.Z,{title:t.method.functionName,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.functionName,onCopy:()=>{}})]})]}):(0,l.jsxs)("div",{className:"flex flex-col w-full space-y-2",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"type"}),(0,l.jsx)("span",{className:"text-foreground",children:"HTTPS endpoint"})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"endpoint"}),(0,l.jsx)(er.Z,{title:t.method.url,copy:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.url,onCopy:()=>{}})]}),(0,l.jsxs)("div",{className:"flex flex-row items-center",children:[(0,l.jsx)("span",{className:"text-foreground-light w-20",children:"secret"}),(0,l.jsx)(er.Z,{copy:!0,title:t.method.secret,reveal:!0,readOnly:!0,disabled:!0,className:"input-mono [&>div>div>div>input]:text-xs [&>div>div>div>input]:opacity-100 flex-1",value:t.method.secret})]})]})}),(0,l.jsx)("div",{className:"flex flex-row gap-2",children:(0,l.jsx)(m.z,{type:"default",disabled:!s,onClick:()=>a(),children:"Configure hook"})})]}),(0,l.jsx)("div",{className:"flex-1",children:t.enabled?(0,l.jsxs)(ea.C,{className:"space-x-1",size:"large",variant:"brand",children:[(0,l.jsx)("div",{className:"h-3.5 w-3.5 bg-brand rounded-full flex justify-center items-center",children:(0,l.jsx)(el.Z,{className:"h-2 w-2 text-background-overlay ",strokeWidth:6})}),(0,l.jsx)("span",{children:"Enabled"})]}):(0,l.jsx)(ea.C,{variant:"warning",size:"large",children:(0,l.jsx)("span",{children:"Disabled"})})})]})},ei=()=>{let{ref:e}=(0,i.UO)(),{data:t,error:s,isError:f}=(0,d.$E)({projectRef:e}),[x,m]=(0,a.useState)(null),[y,N]=(0,a.useState)(null),{mutateAsync:w}=(0,u._)(),S=(0,h.Xo)(r.KA.UPDATE,"custom_config_gotrue"),_=g.map(e=>({...e,enabled:(null==t?void 0:t[e.enabledKey])||!1,method:j((null==t?void 0:t[e.uriKey])||"",(null==t?void 0:t[e.secretsKey])||"")}));return f?(0,l.jsx)(o.Z,{error:s,subject:"Failed to retrieve auth configuration for hooks"}):(0,l.jsxs)("div",{className:"pb-4",children:[(0,l.jsx)(c.ph,{title:"Auth Hooks",description:"Use Postgres functions or HTTP endpoints to customize the behavior of Supabase Auth to meet your needs.",actions:(0,l.jsx)(v,{onSelectHook:m})}),0===_.filter(e=>b(e)).length&&(0,l.jsxs)("div",{className:"border rounded border-default px-20 py-16 flex flex-col items-center justify-center space-y-4",children:[(0,l.jsx)("p",{className:"text-sm text-foreground-light",children:"No hooks configured yet"}),(0,l.jsx)(v,{buttonText:"Add a new hook",onSelectHook:m})]}),(0,l.jsx)("div",{className:"-space-y-px",children:_.filter(e=>b(e)).map(t=>(0,l.jsx)(en,{hook:t,canUpdateConfig:S,onToggle:s=>w({projectRef:e,config:{[t.enabledKey]:s}}),onSelect:()=>{m(t.title)}},t.enabledKey))}),(0,l.jsx)(et,{title:x,visible:!!x,onDelete:()=>{let e=_.find(e=>e.title===x);e&&N(e)},onClose:()=>m(null),authConfig:t}),(0,l.jsx)(p.Z,{visible:!!y,variant:"destructive",title:"Confirm to delete",confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>N(null),onConfirm:async()=>{y&&(await w({projectRef:e,config:{[y.enabledKey]:!1,[y.uriKey]:null,[y.secretsKey]:null}}),n.ZP.success("".concat(y.title," has been deleted.")),N(null),m(null))},children:(0,l.jsx)("p",{className:"py-4 text-sm text-foreground-light",children:"Are you sure you want to delete the ".concat(null==y?void 0:y.title,"?")})})]})};var eo=s(7929),ec=s(14782);let ed=()=>{let e=(0,h.Xo)(r.KA.READ,"custom_config_gotrue");return(0,h.N4)()&&!e?(0,l.jsx)(ec.Z,{isFullPage:!0,resourceText:"access your project's auth hooks"}):(0,l.jsx)(c.ld,{children:(0,l.jsx)(ei,{})})};ed.getLayout=e=>(0,l.jsx)(eo.g1,{children:e});var eu=ed},7117:function(e,t,s){"use strict";s.d(t,{DN:function(){return g},FF:function(){return j},Tu:function(){return m},bC:function(){return b},sw:function(){return d},ue:function(){return x},yo:function(){return c}});var l=s(52322),r=s(70241),a=s(10929),n=s(2784),i=s(8609),o=s(54383);let c=r.fC;r.xz;let d=r.x8,u=(0,a.j)("fixed inset-0 z-40 flex",{variants:{side:{top:"items-start",bottom:"items-end",left:"justify-start",right:"justify-end"}},defaultVariants:{side:"right"}}),h=e=>{let{side:t,children:s,...a}=e;return(0,l.jsx)(r.h_,{...a,children:(0,l.jsx)("div",{className:u({side:t}),children:s})})};h.displayName=r.h_.displayName;let p=n.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,l.jsx)(r.aV,{className:(0,o.cn)("fixed inset-0 z-40 bg-alternative/90 backdrop-blur-sm transition-all duration-100 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=open]:fade-in",s),...n,ref:t})});p.displayName=r.aV.displayName;let f=(0,a.j)("fixed z-40 scale-100 gap-4 bg-studio opacity-100 shadow-lg",{variants:{side:{top:"animate-in slide-in-from-top w-full duration-300 border-b",bottom:"animate-in slide-in-from-bottom w-full duration-300 border-t",left:"animate-in slide-in-from-left h-full duration-300 border-r",right:"animate-in slide-in-from-right h-full duration-300 border-l"},size:{content:"",default:"",sm:"",lg:"",xl:"",xxl:"",full:""}},compoundVariants:[{side:["top","bottom"],size:"content",class:"max-h-screen"},{side:["top","bottom"],size:"default",class:"h-1/3"},{side:["top","bottom"],size:"sm",class:"h-1/4"},{side:["top","bottom"],size:"lg",class:"h-1/2"},{side:["top","bottom"],size:"xl",class:"h-5/6"},{side:["top","bottom"],size:"full",class:"h-screen"},{side:["right","left"],size:"content",class:"max-w-screen"},{side:["right","left"],size:"default",class:"w-1/3"},{side:["right","left"],size:"sm",class:"w-1/4"},{side:["right","left"],size:"lg",class:"w-1/2"},{side:["right","left"],size:"xl",class:"w-4/6"},{side:["right","left"],size:"xxl",class:"w-5/6"},{side:["right","left"],size:"full",class:"w-screen"}],defaultVariants:{side:"right",size:"default"}}),x=n.forwardRef((e,t)=>{let{side:s,size:a,className:n,children:c,showClose:d=!0,...u}=e;return(0,l.jsxs)(h,{side:s,children:[(0,l.jsx)(p,{}),(0,l.jsxs)(r.VY,{ref:t,className:(0,o.cn)(f({side:s,size:a}),n),...u,children:[c,d?(0,l.jsxs)(r.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,l.jsx)(i.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]}):null]})]})});x.displayName=r.VY.displayName;let m=e=>{let{className:t,...s}=e;return(0,l.jsx)("div",{className:(0,o.cn)("px-5 py-4 text-center sm:text-left border-b",t),...s})};m.displayName="SheetHeader";let g=e=>{let{className:t,...s}=e;return(0,l.jsx)("div",{className:(0,o.cn)("px-content py-content",t),...s})};g.displayName="SheetSection";let j=e=>{let{className:t,...s}=e;return(0,l.jsx)("div",{className:(0,o.cn)("px-5 py-3 border-t w-full","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};j.displayName="SheetFooter";let b=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(r.Dx,{ref:t,className:(0,o.cn)("text-base text-foreground",s),...a})});b.displayName=r.Dx.displayName,n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(r.dk,{ref:t,className:(0,o.cn)("text-sm text-foreground-muted",s),...a})}).displayName=r.dk.displayName},93705:function(e,t,s){"use strict";s.d(t,{r:function(){return d}});var l=s(52322),r=s(16530),a=s(10929),n=s(2784),i=s(54383);let o=(0,a.j)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,a.j)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=n.forwardRef((e,t)=>{let{className:s,size:a,...n}=e;return(0,l.jsx)(r.fC,{className:(0,i.cn)(o({size:a}),s),...n,ref:t,children:(0,l.jsx)(r.bU,{className:(0,i.cn)(c({size:a}))})})});d.displayName=r.fC.displayName}},function(e){e.O(0,[667,9678,8183,8421,3844,9785,7263,9818,9595,5191,7127,9104,6917,4531,7309,9229,3832,8475,626,496,1273,8020,7298,9774,2888,179],function(){return e(e.s=46261)}),_N_E=e.O()}]);